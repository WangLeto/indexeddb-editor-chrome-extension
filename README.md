# IndexedDB Editor Chrome Extension

一个Chrome扩展，用于查看和编辑网页中的IndexedDB内容。支持单条记录编辑，避免一次性修改所有数据的风险。

## 功能特点

- 📊 **数据库浏览**: 自动发现并列出当前页面的所有IndexedDB数据库。
- 🗂️ **对象存储查看**: 浏览数据库中的所有对象存储(Object Stores)。
- 📄 **记录列表**:
    - 完整展示对象存储中的所有记录。
    - 显示记录的元数据，如主键(Key)、类型(Type)和大小(Size)。
    - 支持基于主键和内容进行实时搜索过滤。
- 📝 **记录编辑与查看**:
    - 点击记录可进入详情页查看完整数据。
    - 以JSON格式安全地编辑单条记录。
    - 支持对拥有内联主键(in-line key)和外联主键(out-of-line key)的对象存储进行编辑。
- ➕ **添加与删除**:
    - 支持添加新记录。
    - 支持删除指定记录，操作前有确认提示。
- ✅ **安全易用**:
    - 编辑时自动进行JSON格式验证。
    - 所有操作在页面内完成，无需刷新。

## 安装方法

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，进入扩展管理页面 (`chrome://extensions/`)
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹

## 使用方法

1. 导航到包含IndexedDB的网页
2. 点击浏览器工具栏中的IndexedDB Editor图标
3. 在弹出窗口中：
   - 选择要查看的数据库
   - 选择对象存储
   - 查看记录列表
   - 点击记录进行编辑

## 界面说明

- **数据库列表**: 显示当前页面的所有IndexedDB数据库
- **对象存储列表**: 显示选中数据库的所有对象存储
- **记录列表**: 显示选中对象存储的所有记录
- **编辑器**: JSON格式编辑单条记录
- **操作按钮**:
  - `Save`: 保存当前编辑的记录
  - `Delete`: 删除当前记录
  - `Cancel`: 取消编辑
  - `Add New Record`: 添加新记录
  - `Refresh`: 刷新当前视图

## 安全特性

- **单条编辑**: 每次只能编辑一条记录，降低误操作风险
- **JSON验证**: 保存前验证JSON格式，防止数据损坏
- **确认删除**: 删除记录前需要用户确认
- **错误处理**: 完善的错误提示和处理机制

## 技术架构

- `manifest.json`: 扩展的配置文件，定义了扩展的名称、版本、权限等。
- `background.js`: 后台服务工作线程，负责监听扩展图标的点击事件，并向内容脚本发送消息以激活编辑器。
- `content.js`: 内容脚本，被注入到目标页面中。它负责创建和管理编辑器的UI、处理用户交互，并直接与页面的IndexedDB进行通信。
- `editor.css`: 定义了编辑器UI的样式，确保其在不同页面上表现一致。

## 兼容性

- Chrome 88+
- 支持Manifest V3
- 支持所有使用IndexedDB的网站

## 注意事项

- 扩展需要在包含IndexedDB的页面上运行
- 编辑数据前请确保了解数据结构
- 建议在开发环境中测试后再在生产环境使用
- 某些网站可能有CSP限制，影响扩展功能

## 故障排除

如果扩展无法正常工作：

### 常见问题及解决方案

1. **显示 "Failed to load databases" 错误**：
   - 确认当前页面确实使用了IndexedDB
   - 刷新页面后重新打开扩展
   - 检查浏览器控制台是否有错误信息
   - 确保扩展已正确加载（在chrome://extensions/中检查）

2. **扩展图标点击没有反应**：
   - 确认扩展权限设置正确
   - 检查是否在chrome://或about:等特殊页面（这些页面不支持内容脚本）
   - 重新加载扩展

3. **显示 "Content script not available" 错误**：
   - 页面可能有严格的CSP（内容安全策略）限制
   - 刷新页面重试
   - 尝试在不同的网站上使用

4. **数据显示不完整或格式错误**：
   - IndexedDB中的数据可能包含特殊格式
   - 某些复杂对象可能无法完全显示
   - 尝试刷新数据视图

### 测试扩展

1. 使用项目中的 `test.html` 文件：
   - 在浏览器中打开 `test.html`
   - 点击 "Create Test Database" 创建测试数据库
   - 点击 "Add Test Records" 添加测试数据
   - 打开扩展验证是否能正常显示和编辑数据

2. 调试步骤：
   - 打开开发者工具 (F12)
   - 查看Console标签中的错误信息
   - 在Network标签中查看是否有加载失败的资源

### 开发者调试

- 内容脚本日志：打开任意页面的开发者工具控制台
- 后台脚本日志：访问 `chrome://extensions/` → 点击扩展的"检查视图：Service Worker"
- 弹出窗口调试：右键点击扩展图标 → "检查弹出内容"

## 开发

如需修改扩展：

1. 修改相应文件
2. 在扩展管理页面点击刷新按钮
3. 重新测试功能

---

**警告**: 请谨慎编辑生产环境的数据，建议先在开发环境测试。